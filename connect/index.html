<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Connect</title>
    <style>
      :root {
        color-scheme: dark;
      }
      html,
      body {
        height: 100%;
        margin: 0;
        background: #0b0b0b;
        color: #e9e9e9;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      }
      .page {
        min-height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 32px;
        box-sizing: border-box;
      }
      .card {
        width: min(560px, 92vw);
        background: #121212;
        border: 1px solid #1f1f1f;
        border-radius: 16px;
        padding: 28px;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.45);
      }
      .title {
        font-size: 28px;
        font-weight: 700;
        margin: 0 0 8px;
      }
      .subtitle {
        margin: 0 0 20px;
        color: #bdbdbd;
      }
      .row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        padding: 14px 0;
        border-top: 1px solid #1f1f1f;
      }
      .row:first-of-type {
        border-top: 0;
        padding-top: 0;
      }
      .label {
        color: #9d9d9d;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }
      .value {
        font-size: 18px;
        font-weight: 600;
      }
      .status {
        font-size: 14px;
        color: #9d9d9d;
        margin-top: 10px;
      }
      .actions {
        margin-top: 20px;
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
      }
      .servers {
        margin-top: 8px;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      .server-button {
        appearance: none;
        border: 1px solid #2a2a2a;
        background: #151515;
        color: #d0d0d0;
        padding: 8px 12px;
        border-radius: 999px;
        font-weight: 600;
        cursor: pointer;
      }
      .server-button.active {
        background: #2563eb;
        color: #fff;
        border-color: #2563eb;
      }
      .button {
        appearance: none;
        border: 0;
        background: #3b82f6;
        color: #fff;
        padding: 12px 18px;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }
      .button.secondary {
        background: #1f1f1f;
        color: #d9d9d9;
      }
      .note {
        margin-top: 14px;
        color: #7f7f7f;
        font-size: 13px;
        line-height: 1.5;
      }
    </style>
  </head>
  <body>
    <div class="page">
      <div class="card">
        <h1 class="title">hello connect to my server</h1>
        <p class="subtitle">what is this shit ass subtitle</p>
        <div class="row">
          <div>
            <div class="label">Server</div>
            <div class="value" id="server-name">Loading...</div>
          </div>
          <div>
            <div class="label">Players</div>
            <div class="value" id="player-count">—</div>
          </div>
        </div>
        <div class="row">
          <div>
            <div class="label">Address</div>
            <div class="value" id="server-address">—</div>
          </div>
          <div>
            <div class="label">Status</div>
            <div class="value" id="server-status">—</div>
          </div>
        </div>
        <div class="actions">
          <a class="button" id="connect-button" href="#">Connect</a>
          <button class="button secondary" id="refresh-button">Refresh</button>
        </div>
        <div class="servers" id="server-list"></div>
        <div class="status" id="status-text">Fetching server info…</div>
        <div class="note">
          If the count shows offline, make sure the server is public and the
          address below is correct.
        </div>
      </div>
    </div>
    <script>
      const STATUS_URL = "https://your-status-server.example.com/status";
      const SERVERS = [
        { name: "CROW'S ZCITY | EU 1 | OPEN", address: "45.152.160.251:25569" },
        { name: "CROW'S ZCITY | EU 2 | OPEN", address: "45.152.160.251:25648" }
      ];

      const serverNameEl = document.getElementById("server-name");
      const playerCountEl = document.getElementById("player-count");
      const serverAddressEl = document.getElementById("server-address");
      const serverStatusEl = document.getElementById("server-status");
      const statusTextEl = document.getElementById("status-text");
      const connectButtonEl = document.getElementById("connect-button");
      const refreshButtonEl = document.getElementById("refresh-button");
      const serverListEl = document.getElementById("server-list");

      let selectedServer = SERVERS[0];
      let statusCache = new Map();

      function setActiveServer(server) {
        selectedServer = server;
        serverAddressEl.textContent = server.address;
        connectButtonEl.href = `steam://connect/${server.address}`;
        Array.from(serverListEl.children).forEach((button) => {
          button.classList.toggle("active", button.dataset.address === server.address);
        });
        loadServerInfo();
      }

      function renderServers() {
        serverListEl.innerHTML = "";
        SERVERS.forEach((server) => {
          const button = document.createElement("button");
          button.className = "server-button";
          button.type = "button";
          button.textContent = server.name;
          button.dataset.address = server.address;
          button.addEventListener("click", () => setActiveServer(server));
          serverListEl.appendChild(button);
        });
      }

      async function fetchStatusFeed() {
        if (!STATUS_URL) {
          return;
        }
        try {
          const response = await fetch(STATUS_URL, { cache: "no-store" });
          const data = await response.json();
          const servers = Array.isArray(data)
            ? data
            : Array.isArray(data?.servers)
              ? data.servers
              : [];
          statusCache = new Map();
          servers.forEach((server) => {
            const address =
              server.address ||
              server.ip ||
              (server.host && server.port ? `${server.host}:${server.port}` : "");
            if (!address) {
              return;
            }
            statusCache.set(address, server);
          });
        } catch (error) {
          statusCache = new Map();
        }
      }

      function applyStatusFromFeed(server) {
        const entry = statusCache.get(selectedServer.address);
        if (!entry) {
          serverNameEl.textContent = selectedServer.name;
          playerCountEl.textContent = "—";
          serverStatusEl.textContent = "Offline";
          statusTextEl.textContent = "No server data found at that address.";
          return;
        }
        serverNameEl.textContent = entry.name || selectedServer.name;
        if (typeof entry.players === "number" && typeof entry.max_players === "number") {
          playerCountEl.textContent = `${entry.players}/${entry.max_players}`;
        } else {
          playerCountEl.textContent = "—";
        }
        serverStatusEl.textContent = entry.success === false ? "Offline" : "Online";
        statusTextEl.textContent =
          entry.success === false ? "Server is offline." : "Server is online.";
      }

      async function loadServerInfo() {
        statusTextEl.textContent = "Fetching server info…";
        serverStatusEl.textContent = "Checking";
        if (STATUS_URL) {
          await fetchStatusFeed();
          applyStatusFromFeed();
          return;
        }
        serverNameEl.textContent = selectedServer.name;
        playerCountEl.textContent = "—";
        serverStatusEl.textContent = "Offline";
        statusTextEl.textContent = "Set STATUS_URL to load live data.";
      }

      refreshButtonEl.addEventListener("click", loadServerInfo);
      renderServers();
      setActiveServer(selectedServer);
    </script>
  </body>
</html>
